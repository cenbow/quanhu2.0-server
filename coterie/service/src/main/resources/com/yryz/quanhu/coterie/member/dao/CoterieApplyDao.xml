<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.yryz.quanhu.coterie.member.dao.CoterieApplyDao">


    <!--

    /*  成员申请表  */
    CREATE TABLE `service-circle`.`coterie_apply`(
    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '自增主键',
    `coterie_id` CHAR(12) NOT NULL COMMENT '私圈ID',
    `cust_id` VARCHAR(64) COMMENT '用户ID',
    `status` tinyint(3) unsigned DEFAULT 2 COMMENT '0通过，1未通过，2待审核',
    `reason` VARCHAR(512) COMMENT '加入理由',
    `create_date` DATETIME not null  DEFAULT CURRENT_TIMESTAMP COMMENT '加入时间',
    `process_time` DATETIME COMMENT '审批时间',
    `last_update_date` timestamp not null DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    PRIMARY KEY (`id`)
    )ENGINE=InnoDB  DEFAULT CHARSET=utf8mb4 COMMENT='私圈申请表';

    -->

    <insert id="insert" useGeneratedKeys="true" keyProperty="id" keyColumn="id"
            parameterType="com.yryz.quanhu.coterie.member.entity.CoterieMemberApply">
        insert into qh_coterie_apply (
        coterie_id
        ,user_id
        ,member_status
        ,reason
        ,create_date
        ,process_time
        ,last_update_date
        ) values(
        #{coterieId,jdbcType=BIGINT}
        ,#{userId,jdbcType=BIGINT}
        ,#{memberStatus,jdbcType=TINYINT}
        ,#{reason,jdbcType=VARCHAR}
        ,NOW()
        ,NOW()
        ,NOW()
        )
    </insert>



    <!--<select id="selectAll" resultType="com.yryz.activeii.coterie.member.model.MemberApply">-->
        <!--select * from coterie_apply T;-->
    <!--</select>-->

    <!--<select id="select" resultType="com.yryz.activeii.coterie.member.model.MemberApply">-->
        <!--select * from coterie_apply T limit #{page.firstRecord},#{page.maxRecord};-->
    <!--</select>-->



    <!--<select id="selectOne" resultType="com.yryz.activeii.coterie.member.model.MemberApply">-->
        <!--select * from coterie_apply t-->
        <!--<where>-->
            <!--<if test="coterieId != null">-->
                <!--coterie_id = #{coterieId}-->
            <!--</if>-->
            <!--<if test="custId != null">-->
                <!--and cust_id = #{custId}-->
            <!--</if>-->
        <!--</where>-->
    <!--</select>-->


    <!--<update id="update" parameterType="com.yryz.activeii.coterie.member.model.MemberApply" >-->
        <!--update coterie_apply set-->
        <!--last_update_date = NOW()-->
        <!--<if test="status != null">-->
            <!--,status = #{status}-->
        <!--</if>-->
        <!--where id = #{id}-->
    <!--</update>-->

    <update id="updateByCoterieApply" parameterType="com.yryz.quanhu.coterie.member.entity.CoterieMemberApply" >
        update qh_coterie_apply set
        last_update_date = NOW()
        <if test="memberStatus != null">
            ,kick_status = #{kickStatus}
        </if>
        <if test="delFlag!= null">
            ,del_flag= #{delFlag}
        </if>
        <if test="processTime!= null">
            ,process_time= #{processTime}
        </if>
        where coterie_id = #{coterieId} and user_id = #{userId}
    </update>


</mapper>